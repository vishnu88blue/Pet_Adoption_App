"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["158"],{1816:function(e,t,i){i.d(t,{$:function(){return z}});var a=i(7126),n=i(2631),o=i(4194),r=i(8969),l=i(3064),s=i(9885),c=i(8655),d=i(1085),u=i(8748),g=i(8493),h=i(5727),p=i(8181),v=i(7484);let z=(0,s.withCardStateProvider)(e=>{var t,i;let z=(0,s.useCardState)(),m=(0,r.a2)({onNextStep:()=>z.setError(void 0)}),C=o.useRef(null),{createOrganization:S,isLoaded:x,setActive:b,userMemberships:Z}=(0,n.eW)({userMemberships:v.AO.userMemberships}),{organization:f}=(0,n.o8)(),[$,w]=o.useState(),y=(0,u.Yp)("name","",{type:"text",label:(0,d.u1)("formFieldLabel__organizationName"),placeholder:(0,d.u1)("formFieldInputPlaceholder__organizationName")}),P=(0,u.Yp)("slug","",{type:"text",label:(0,d.u1)("formFieldLabel__organizationSlug"),placeholder:(0,d.u1)("formFieldInputPlaceholder__organizationSlug")}),L=!!y.value,A=async t=>{if(t.preventDefault(),L&&x)try{var i,a;let t={name:y.value};e.hideSlug||(t.slug=P.value);let n=await S(t);if($&&await n.setLogo({file:$}),C.current=n,await b({organization:n}),null===(i=Z.revalidate)||void 0===i||i.call(Z),null!==(a=e.skipInvitationScreen)&&void 0!==a?a:1===n.maxAllowedMemberships)return T();m.nextStep()}catch(e){(0,u.S3)(e,[y,P],z.setError)}},T=()=>{var t;e.navigateAfterCreateOrganization(C.current),null===(t=e.onComplete)||void 0===t||t.call(e)},B=e=>{P.setValue(e)},k="organizationList"===e.flow?"subtitle":void 0;return(0,a.BX)(r.en,{...m.props,children:[(0,a.tZ)(s.FormContainer,{headerTitle:null==e?void 0:null===(t=e.startPage)||void 0===t?void 0:t.headerTitle,headerSubtitle:null==e?void 0:null===(i=e.startPage)||void 0===i?void 0:i.headerSubtitle,headerTitleTextVariant:"h2",headerSubtitleTextVariant:k,sx:e=>({minHeight:e.sizes.$60,gap:e.space.$6,textAlign:"left"}),children:(0,a.BX)(s.Form.Root,{onSubmit:A,sx:e=>({gap:e.space.$6}),children:[(0,a.tZ)(l.Col,{children:(0,a.tZ)(p.D,{organization:{name:y.value},onAvatarChange:async e=>await w(e),onAvatarRemove:$?()=>(z.setIdle(),w(null)):null,avatarPreviewPlaceholder:(0,a.tZ)(s.IconButton,{variant:"ghost","aria-label":"Upload organization logo",icon:(0,a.tZ)(l.Icon,{size:"md",icon:c.gq,sx:e=>({color:e.colors.$colorTextSecondary,transitionDuration:e.transitionDuration.$controls})}),sx:e=>({width:e.sizes.$16,height:e.sizes.$16,borderRadius:e.radii.$md,borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$dashed,borderColor:e.colors.$neutralAlpha200,backgroundColor:e.colors.$neutralAlpha50,":hover":{backgroundColor:e.colors.$neutralAlpha50,svg:{transform:"scale(1.2)"}}})})})}),(0,a.tZ)(s.Form.ControlRow,{elementId:y.id,children:(0,a.tZ)(s.Form.PlainInput,{...y.props,onChange:e=>{y.setValue(e.target.value),B((0,u.qi)(e.target.value))},isRequired:!0,autoFocus:!0,ignorePasswordManager:!0})}),!e.hideSlug&&(0,a.tZ)(s.Form.ControlRow,{elementId:P.id,children:(0,a.tZ)(s.Form.PlainInput,{...P.props,onChange:e=>{B(e.target.value)},isRequired:!0,pattern:"^[a-z0-9\\-]+$",ignorePasswordManager:!0})}),(0,a.BX)(s.FormButtonContainer,{sx:e=>({marginTop:e.space.$none}),children:[(0,a.tZ)(s.Form.SubmitButton,{block:!1,isDisabled:!L,localizationKey:(0,d.u1)("createOrganization.formButtonSubmit")}),e.onCancel&&(0,a.tZ)(s.Form.ResetButton,{localizationKey:(0,d.u1)("userProfile.formButtonReset"),block:!1,onClick:e.onCancel})]})]})}),(0,a.tZ)(s.FormContainer,{headerTitle:(0,d.u1)("organizationProfile.invitePage.title"),headerTitleTextVariant:"h2",headerSubtitleTextVariant:k,sx:e=>({minHeight:e.sizes.$60,textAlign:"left"}),children:f&&(0,a.tZ)(g.l,{resetButtonLabel:(0,d.u1)("createOrganization.invitePage.formButtonReset"),onSuccess:m.nextStep,onReset:T})}),(0,a.BX)(l.Col,{children:[(0,a.tZ)(s.Header.Root,{children:(0,a.tZ)(s.Header.Title,{localizationKey:(0,d.u1)("organizationProfile.invitePage.title"),sx:{textAlign:"left"}})}),(0,a.tZ)(s.SuccessPage,{contents:(0,a.tZ)(h.a,{}),sx:e=>({minHeight:e.sizes.$60}),onFinish:T})]})]})})},125:function(e,t,i){i.r(t),i.d(t,{OrganizationList:()=>_});var a=i("7126"),n=i("7571"),o=i("3064"),r=i("4676"),l=i("2631"),s=i("4194"),c=i("9885"),d=i("6391"),u=i("8655"),g=i("1816"),h=i("5295");let p=e=>(0,a.tZ)(o.Col,{elementDescriptor:o.descriptors.organizationListPreviewItems,sx:e=>({maxHeight:"calc(8 * ".concat(e.sizes.$12,")"),overflowY:"auto",borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,...h.common.unstyledScrollbar(e)}),children:e.children}),v=e=>({padding:"".concat(e.space.$4," ").concat(e.space.$5)}),z=e=>({color:e.colors.$colorText,":hover":{color:e.colors.$colorText}}),m=e=>(0,a.BX)(o.Flex,{align:"center",gap:2,sx:[e=>({minHeight:"unset",justifyContent:"space-between",borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100}),v],elementDescriptor:o.descriptors.organizationListPreviewItem,children:[(0,a.tZ)(c.OrganizationPreview,{elementId:"organizationList",mainIdentifierSx:z,organization:e.organizationData}),e.children]}),C=(0,s.forwardRef)((e,t)=>(0,a.tZ)(o.Box,{ref:t,sx:e=>({width:"100%",height:e.space.$12,position:"relative"}),children:(0,a.tZ)(o.Box,{sx:{margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,a.tZ)(o.Spinner,{size:"sm",colorScheme:"primary",elementDescriptor:o.descriptors.spinner})})})),S=e=>(0,a.tZ)(o.Button,{elementDescriptor:o.descriptors.organizationListPreviewItemActionButton,textVariant:"buttonSmall",variant:"outline",size:"xs",...e}),x=e=>(0,a.tZ)(c.PreviewButton,{elementDescriptor:o.descriptors.organizationListPreviewButton,sx:[v],icon:u.nR,...e});var b=i("8748"),Z=i("7484"),f=i("1085");let $=(0,c.withCardStateProvider)(e=>{let t=(0,c.useCardState)(),{navigateAfterSelectOrganization:i}=(0,n.useOrganizationListContext)(),{isLoaded:o,setActive:r}=(0,l.eW)();if(!o)return null;let s=e=>t.runAsync(async()=>{await r({organization:e}),await i(e)});return(0,a.tZ)(x,{onClick:()=>s(e.organization),children:(0,a.tZ)(c.OrganizationPreview,{elementId:"organizationList",mainIdentifierSx:z,organization:e.organization})})}),w=(0,c.withCardStateProvider)(()=>{let e=(0,c.useCardState)(),{hidePersonal:t,navigateAfterSelectPersonal:i}=(0,n.useOrganizationListContext)(),{isLoaded:o,setActive:r}=(0,l.eW)(),{user:s}=(0,l.aF)();if(!s)return null;let{username:d,primaryEmailAddress:u,primaryPhoneNumber:g,...h}=s;return t?null:(0,a.tZ)(x,{onClick:()=>{if(o)return e.runAsync(async()=>{await r({organization:null}),await i(s)})},children:(0,a.tZ)(c.PersonalWorkspacePreview,{user:h,mainIdentifierSx:z,title:(0,f.u1)("organizationSwitcher.personalWorkspace")})})}),y={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},P=e=>{let t=(0,c.useCardState)();return(0,a.tZ)(S,{isLoading:t.isLoading,onClick:e.onAccept,localizationKey:(0,o.localizationKeys)("organizationList.action__invitationAccept")})},L=(0,c.withCardStateProvider)(e=>{let t=(0,c.useCardState)(),{getOrganization:i}=(0,l.cL)(),[n,o]=(0,s.useState)(null),{userInvitations:r}=(0,l.eW)({userInvitations:y.userInvitations,userMemberships:y.userMemberships});return n?(0,a.tZ)($,{organization:n}):(0,a.tZ)(m,{organizationData:e.publicOrganizationData,children:(0,a.tZ)(P,{onAccept:()=>t.runAsync(async()=>[await e.accept(),await i(e.publicOrganizationData.id)]).then(e=>{var t;let[i,a]=e;null==r||null===(t=r.setData)||void 0===t||t.call(r,e=>(0,Z.Sz)(i,e,"negative")),o(a)}).catch(e=>(0,b.S3)(e,[],t.setError))})})}),A=e=>{let t=(0,c.useCardState)(),{userSuggestions:i}=(0,l.eW)({userSuggestions:y.userSuggestions});return"accepted"===e.status?(0,a.tZ)(o.Text,{colorScheme:"secondary",localizationKey:(0,o.localizationKeys)("organizationList.suggestionsAcceptedLabel")}):(0,a.tZ)(S,{isLoading:t.isLoading,onClick:()=>t.runAsync(e.accept).then(e=>{var t;return null==i?void 0:null===(t=i.setData)||void 0===t?void 0:t.call(i,t=>(0,Z.Sz)(e,t))}).catch(e=>(0,b.S3)(e,[],t.setError)),localizationKey:(0,o.localizationKeys)("organizationList.action__suggestionsAccept")})},T=(0,c.withCardStateProvider)(e=>(0,a.tZ)(m,{organizationData:e.publicOrganizationData,children:(0,a.tZ)(A,{...e})})),B=()=>{let{userMemberships:e,userInvitations:t,userSuggestions:i}=(0,l.eW)(y),{ref:a}=(0,d.YD)({threshold:0,onChange:a=>{var n,o,r;a&&(e.hasNextPage?null===(n=e.fetchNext)||void 0===n||n.call(e):t.hasNextPage?null===(o=t.fetchNext)||void 0===o||o.call(t):null===(r=i.fetchNext)||void 0===r||r.call(i))}});return{userMemberships:e,userInvitations:t,userSuggestions:i,ref:a}},k=e=>{let{onCreateOrganizationClick:t}=e,{user:i}=(0,l.aF)();return(null==i?void 0:i.createOrganizationEnabled)?(0,a.tZ)(c.Action,{elementDescriptor:o.descriptors.organizationListCreateOrganizationActionButton,icon:u.mm,label:(0,o.localizationKeys)("organizationList.action__createOrganization"),onClick:t,sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,padding:"".concat(e.space.$5," ").concat(e.space.$5)}),iconSx:e=>({width:e.sizes.$9,height:e.sizes.$6})}):null},F=(0,c.withCardStateProvider)(()=>{let e=(0,c.useCardState)(),{userMemberships:t,userSuggestions:i,userInvitations:r}=B(),l=(null==t?void 0:t.isLoading)||(null==r?void 0:r.isLoading)||(null==i?void 0:i.isLoading),s=!!((null==t?void 0:t.count)||(null==r?void 0:r.count)||(null==i?void 0:i.count)),{hidePersonal:d}=(0,n.useOrganizationListContext)();return(0,a.BX)(c.Card.Root,{children:[(0,a.BX)(c.Card.Content,{sx:e=>({padding:"".concat(e.space.$8," ").concat(e.space.$none," ").concat(e.space.$none)}),children:[(0,a.tZ)(c.Card.Alert,{sx:e=>({margin:"".concat(e.space.$none," ").concat(e.space.$5)}),children:e.error}),l&&(0,a.tZ)(o.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$60}),children:(0,a.tZ)(o.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:o.descriptors.spinner})}),!l&&(0,a.tZ)(I,{showListInitially:!(d&&!s)})]}),(0,a.tZ)(c.Card.Footer,{})]})}),I=e=>{let{showListInitially:t}=e,{navigateAfterCreateOrganization:i,skipInvitationScreen:r,hideSlug:l}=(0,n.useOrganizationListContext)(),[c,d]=(0,s.useState)(!t);return(0,a.BX)(a.HY,{children:[!c&&(0,a.tZ)(O,{onCreateOrganizationClick:()=>d(!0)}),c&&(0,a.tZ)(o.Box,{sx:e=>({padding:"".concat(e.space.$none," ").concat(e.space.$5," ").concat(e.space.$5)}),children:(0,a.tZ)(g.$,{flow:"organizationList",startPage:{headerTitle:(0,o.localizationKeys)("organizationList.createOrganization")},skipInvitationScreen:r,navigateAfterCreateOrganization:e=>i(e).then(()=>d(!1)),onCancel:t&&c?()=>d(!1):void 0,hideSlug:l})})]})},O=e=>{var t,i,r;let l=(0,n.useEnvironment)(),{ref:s,userMemberships:d,userSuggestions:u,userInvitations:g}=B(),{hidePersonal:h}=(0,n.useOrganizationListContext)(),v=(null==d?void 0:d.isLoading)||(null==g?void 0:g.isLoading)||(null==u?void 0:u.isLoading),z=(null==d?void 0:d.hasNextPage)||(null==g?void 0:g.hasNextPage)||(null==u?void 0:u.hasNextPage),m=null===(t=g.data)||void 0===t?void 0:t.filter(e=>!!e),S=null===(i=u.data)||void 0===i?void 0:i.filter(e=>!!e);return(0,a.BX)(a.HY,{children:[(0,a.BX)(c.Header.Root,{sx:e=>({padding:"".concat(e.space.$none," ").concat(e.space.$8)}),children:[(0,a.tZ)(c.Header.Title,{localizationKey:(0,o.localizationKeys)(h?"organizationList.titleWithoutPersonal":"organizationList.title")}),(0,a.tZ)(c.Header.Subtitle,{localizationKey:(0,o.localizationKeys)("organizationList.subtitle",{applicationName:l.displayConfig.applicationName})})]}),(0,a.tZ)(o.Col,{elementDescriptor:o.descriptors.main,children:(0,a.tZ)(p,{children:(0,a.BX)(c.Actions,{role:"menu",children:[(0,a.tZ)(w,{}),(d.count||0)>0&&(null===(r=d.data)||void 0===r?void 0:r.map(e=>(0,a.tZ)($,{...e},e.id))),!d.hasNextPage&&(null==m?void 0:m.map(e=>(0,a.tZ)(L,{...e},e.id))),!d.hasNextPage&&!g.hasNextPage&&(null==S?void 0:S.map(e=>(0,a.tZ)(T,{...e},e.id))),(z||v)&&(0,a.tZ)(C,{ref:s}),(0,a.tZ)(k,{onCreateOrganizationClick:()=>{e.onCreateOrganizationClick()}})]})})})]})},D=(0,n.withCoreUserGuard)(F),_=()=>(0,a.tZ)(o.Flow.Root,{flow:"organizationList",children:(0,a.tZ)(o.Flow.Part,{children:(0,a.tZ)(r.Switch,{children:(0,a.tZ)(r.Route,{children:(0,a.tZ)(D,{})})})})})}}]);