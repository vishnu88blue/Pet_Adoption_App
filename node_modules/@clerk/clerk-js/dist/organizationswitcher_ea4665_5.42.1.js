"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["780"],{86:function(t,e,i){i.r(e),i.d(e,{OrganizationSwitcher:()=>L});var o=i("7126"),n=i("4194"),r=i("7571"),a=i("3064"),c=i("9885"),l=i("6391"),s=i("2631"),d=i("3314"),u=i("8969"),p=i("3929"),g=i("8655"),h=i("4676"),v=i("5295"),z=i("8748"),m=i("7484");let w=()=>{let{userInvitations:t,userSuggestions:e}=(0,s.eW)(m.AO),{ref:i}=(0,l.YD)({threshold:0,onChange:i=>{var o,n;i&&(t.hasNextPage?null===(o=t.fetchNext)||void 0===o||o.call(t):null===(n=e.fetchNext)||void 0===n||n.call(e))}});return{userInvitations:t,userSuggestions:e,ref:i}},S=t=>{let e=(0,c.useCardState)(),{userSuggestions:i}=(0,s.eW)({userSuggestions:m.AO.userSuggestions});return"accepted"===t.status?(0,o.tZ)(a.Text,{colorScheme:"secondary",localizationKey:(0,a.localizationKeys)("organizationSwitcher.suggestionsAcceptedLabel")}):(0,o.tZ)(a.Button,{elementDescriptor:a.descriptors.organizationSwitcherInvitationAcceptButton,textVariant:"buttonSmall",variant:"outline",colorScheme:"neutral",size:"sm",isLoading:e.isLoading,onClick:()=>e.runAsync(t.accept).then(t=>{var e;return null==i?void 0:null===(e=i.setData)||void 0===e?void 0:e.call(i,e=>(0,m.Sz)(t,e))}).catch(t=>(0,z.S3)(t,[],e.setError)),localizationKey:(0,a.localizationKeys)("organizationSwitcher.action__suggestionsAccept")})},x=t=>{let e=(0,c.useCardState)();return(0,o.tZ)(a.Button,{elementDescriptor:a.descriptors.organizationSwitcherInvitationAcceptButton,textVariant:"buttonSmall",variant:"outline",colorScheme:"neutral",size:"xs",isLoading:e.isLoading,onClick:t.onAccept,localizationKey:(0,a.localizationKeys)("organizationSwitcher.action__invitationAccept")})},f=t=>{let{children:e,publicOrganizationData:i}=t;return(0,o.BX)(a.Flex,{align:"center",gap:2,sx:t=>({justifyContent:"space-between",padding:"".concat(t.space.$4," ").concat(t.space.$5)}),elementDescriptor:a.descriptors.organizationSwitcherPopoverInvitationActionsBox,children:[(0,o.tZ)(c.OrganizationPreview,{elementId:"organizationSwitcherListedOrganization",organization:i,sx:t=>({color:t.colors.$colorTextSecondary,":hover":{color:t.colors.$colorTextSecondary}})}),e]})},B=(0,c.withCardStateProvider)(t=>{var e;let{invitation:i,onOrganizationClick:n}=t,{accept:l,publicOrganizationData:d,status:u}=i,p=(0,c.useCardState)(),{getOrganization:h}=(0,s.cL)(),{organization:v}=(0,s.o8)(),{userInvitations:w}=(0,s.eW)({userInvitations:m.AO.userInvitations,userMemberships:m.AO.userMemberships}),{acceptedInvitations:S,setAcceptedInvitations:B}=(0,r.useAcceptedInvitations)(),A=null===(e=S.find(t=>t.invitation.id===i.id))||void 0===e?void 0:e.organization;return"accepted"===u?(null==A?void 0:A.id)&&(null==v?void 0:v.id)===A.id?null:(0,o.tZ)(c.PreviewButton,{elementDescriptor:a.descriptors.organizationSwitcherPreviewButton,icon:g.nR,onClick:A?()=>n(A):void 0,role:"menuitem",children:(0,o.tZ)(c.OrganizationPreview,{elementId:"organizationSwitcherListedOrganization",organization:d,sx:t=>({color:t.colors.$colorTextSecondary,":hover":{color:t.colors.$colorTextSecondary}})})}):(0,o.tZ)(f,{publicOrganizationData:d,children:(0,o.tZ)(x,{onAccept:()=>p.runAsync(async()=>[await l(),await h(d.id)]).then(t=>{var e;let[i,o]=t;null==w||null===(e=w.setData)||void 0===e||e.call(w,t=>(0,m.Sz)(i,t,"negative")),B(t=>[...t,{organization:o,invitation:i}])}).catch(t=>(0,z.S3)(t,[],p.setError))})})}),A=t=>{let{showBorder:e,...i}=t;return(0,o.tZ)(c.Actions,{role:"menu",...i})},P=(0,c.withCardStateProvider)(t=>(0,o.tZ)(f,{publicOrganizationData:t.publicOrganizationData,children:(0,o.tZ)(S,{...t})})),b=t=>{var e,i;let{onOrganizationClick:n}=t,{ref:r,userSuggestions:c,userInvitations:l}=w(),s=l.isLoading||c.isLoading,d=l.hasNextPage||c.hasNextPage,p=(null===(e=l.data)||void 0===e?void 0:e.filter(t=>!!t))||[],g=(null===(i=c.data)||void 0===i?void 0:i.filter(t=>!!t))||[],h=p.length>0||g.length>0;return h||s?(0,o.tZ)(A,{showBorder:h||s,elementDescriptor:a.descriptors.organizationSwitcherPopoverInvitationActions,children:(0,o.BX)(a.Box,{sx:t=>({maxHeight:"calc(4 * ".concat(t.sizes.$17," + 4px)"),overflowY:"auto",...v.common.unstyledScrollbar(t)}),children:[null==p?void 0:p.map(t=>(0,o.tZ)(B,{invitation:t,onOrganizationClick:n},t.id)),!l.hasNextPage&&(null==g?void 0:g.map(t=>(0,o.tZ)(P,{...t},t.id))),(d||s)&&(0,o.tZ)(u.q7,{ref:r})]})}):null},Z=()=>{let{userMemberships:t}=(0,s.eW)({userMemberships:m.AO.userMemberships}),{ref:e}=(0,l.YD)({threshold:0,onChange:e=>{if(e&&t.hasNextPage){var i;null===(i=t.fetchNext)||void 0===i||i.call(t)}}});return{userMemberships:t,ref:e}},O=t=>{let{onPersonalWorkspaceClick:e,onOrganizationClick:i}=t,{hidePersonal:n}=(0,r.useOrganizationSwitcherContext)(),{organization:l}=(0,s.o8)(),{ref:d,userMemberships:p}=Z(),{user:h}=(0,s.aF)(),z=((p.count||0)>0&&p.data||[]).map(t=>t.organization).filter(t=>t.id!==(null==l?void 0:l.id));if(!h)return null;let{username:m,primaryEmailAddress:w,primaryPhoneNumber:S,...x}=h,{isLoading:f,hasNextPage:B}=p;return(0,o.BX)(a.Box,{sx:t=>({maxHeight:"calc((4 * ".concat(t.sizes.$17,") + 4px)"),overflowY:"auto","> button,div":{border:"0 solid ".concat(t.colors.$neutralAlpha100)},">:not([hidden])~:not([hidden])":{borderTopWidth:"1px",borderBottomWidth:"0"},...v.common.unstyledScrollbar(t)}),role:"group","aria-label":n?"List of all organization memberships":"List of all accounts",children:[l&&!n&&(0,o.tZ)(c.PreviewButton,{elementDescriptor:a.descriptors.organizationSwitcherPreviewButton,icon:g.nR,onClick:e,role:"menuitem",children:(0,o.tZ)(c.PersonalWorkspacePreview,{user:x,mainIdentifierVariant:"buttonLarge",title:(0,a.localizationKeys)("organizationSwitcher.personalWorkspace")})}),z.map(t=>(0,o.tZ)(c.PreviewButton,{elementDescriptor:a.descriptors.organizationSwitcherPreviewButton,icon:g.nR,onClick:()=>i(t),role:"menuitem",sx:t=>({border:"0 solid ".concat(t.colors.$neutralAlpha100)}),children:(0,o.tZ)(c.OrganizationPreview,{elementId:"organizationSwitcherListedOrganization",organization:t})},t.id)),(B||f)&&(0,o.tZ)(u.q7,{ref:d})]})},C=t=>{let{onCreateOrganizationClick:e}=t,{user:i}=(0,s.aF)();return(null==i?void 0:i.createOrganizationEnabled)?(0,o.tZ)(c.Action,{elementDescriptor:a.descriptors.organizationSwitcherPopoverActionButton,elementId:a.descriptors.organizationSwitcherPopoverActionButton.setId("createOrganization"),iconBoxElementDescriptor:a.descriptors.organizationSwitcherPopoverActionButtonIconBox,iconBoxElementId:a.descriptors.organizationSwitcherPopoverActionButtonIconBox.setId("createOrganization"),iconElementDescriptor:a.descriptors.organizationSwitcherPopoverActionButtonIcon,iconElementId:a.descriptors.organizationSwitcherPopoverActionButtonIcon.setId("createOrganization"),icon:g.mm,label:(0,a.localizationKeys)("organizationSwitcher.action__createOrganization"),onClick:e,sx:t=>({padding:"".concat(t.space.$5," ").concat(t.space.$5)}),iconSx:t=>({width:t.sizes.$9,height:t.sizes.$6}),iconBoxSx:t=>({width:t.sizes.$9,height:t.sizes.$6}),spinnerSize:"sm"}):null},I=t=>{let{onCreateOrganizationClick:e,onPersonalWorkspaceClick:i,onOrganizationClick:n}=t;return(0,o.BX)(o.HY,{children:[(0,o.tZ)(b,{onOrganizationClick:n}),(0,o.tZ)(O,{onPersonalWorkspaceClick:i,onOrganizationClick:n}),(0,o.tZ)(C,{onCreateOrganizationClick:e})]})},y=n.forwardRef((t,e)=>{let{close:i,...n}=t,l=()=>null==i?void 0:i(!1),u=(0,c.useCardState)(),{__experimental_asStandalone:v}=(0,r.useOrganizationSwitcherContext)(),{openOrganizationProfile:z,openCreateOrganization:m}=(0,s.cL)(),{organization:w}=(0,s.o8)(),{isLoaded:S,setActive:x}=(0,s.eW)(),f=(0,h.useRouter)(),{hidePersonal:B,__unstable_manageBillingUrl:A,__unstable_manageBillingLabel:P,__unstable_manageBillingMembersLimit:b,createOrganizationMode:Z,organizationProfileMode:O,afterLeaveOrganizationUrl:C,afterCreateOrganizationUrl:y,navigateCreateOrganization:k,navigateOrganizationProfile:D,afterSelectOrganizationUrl:_,afterSelectPersonalUrl:L,organizationProfileProps:R,skipInvitationScreen:W,hideSlug:E}=(0,r.useOrganizationSwitcherContext)(),{user:T}=(0,s.aF)();if(!T)return null;let{username:F,primaryEmailAddress:K,primaryPhoneNumber:N,...X}=T;if(!S)return null;let M=()=>(l(),"navigation"===O)?D():z({...R,afterLeaveOrganizationUrl:C,__unstable_manageBillingUrl:A,__unstable_manageBillingLabel:P,__unstable_manageBillingMembersLimit:b}),Y=(0,o.tZ)(c.SmallAction,{elementDescriptor:a.descriptors.organizationSwitcherPopoverActionButton,elementId:a.descriptors.organizationSwitcherPopoverActionButton.setId("manageOrganization"),iconBoxElementDescriptor:a.descriptors.organizationSwitcherPopoverActionButtonIconBox,iconBoxElementId:a.descriptors.organizationSwitcherPopoverActionButtonIconBox.setId("manageOrganization"),iconElementDescriptor:a.descriptors.organizationSwitcherPopoverActionButtonIcon,iconElementId:a.descriptors.organizationSwitcherPopoverActionButtonIcon.setId("manageOrganization"),icon:g.tc,label:(0,a.localizationKeys)("organizationSwitcher.action__manageOrganization"),onClick:()=>M(),trailing:(0,o.tZ)($,{})}),j=(0,o.tZ)(c.SmallAction,{icon:g.Nj,label:(0,d.OR)(P)||"Upgrade",onClick:()=>f.navigate((0,d.OR)(A))});return(0,o.tZ)(p.r,{elementDescriptor:a.descriptors.organizationSwitcherPopoverRootBox,children:(0,o.BX)(c.PopoverCard.Root,{elementDescriptor:a.descriptors.organizationSwitcherPopoverCard,ref:e,role:"dialog","aria-label":"".concat(null==w?void 0:w.name," is active"),shouldEntryAnimate:!v,...n,children:[(0,o.tZ)(c.PopoverCard.Content,{elementDescriptor:a.descriptors.organizationSwitcherPopoverMain,children:(0,o.BX)(c.Actions,{elementDescriptor:a.descriptors.organizationSwitcherPopoverActions,role:"menu",children:[w?A?(0,o.BX)(o.HY,{children:[(0,o.tZ)(c.OrganizationPreview,{elementId:"organizationSwitcherActiveOrganization",organization:w,user:T,fetchRoles:!0,mainIdentifierVariant:"buttonLarge",sx:t=>({padding:"".concat(t.space.$4," ").concat(t.space.$5)})}),(0,o.tZ)(c.Actions,{role:"menu",sx:t=>({borderBottomWidth:t.borderWidths.$normal,borderBottomStyle:t.borderStyles.$solid,borderBottomColor:t.colors.$neutralAlpha100}),children:(0,o.BX)(a.Flex,{justify:"between",sx:t=>({marginLeft:t.space.$12,padding:"0 ".concat(t.space.$5," ").concat(t.space.$4),gap:t.space.$2}),children:[Y,j]})})]}):(0,o.BX)(a.Flex,{justify:"between",align:"center",sx:t=>({width:"100%",paddingRight:t.space.$5}),children:[(0,o.tZ)(c.OrganizationPreview,{elementId:"organizationSwitcherActiveOrganization",organization:w,user:T,fetchRoles:!0,mainIdentifierVariant:"buttonLarge",sx:t=>({padding:"".concat(t.space.$4," ").concat(t.space.$5)})}),(0,o.tZ)(c.Actions,{role:"menu",children:Y})]}):!B&&(0,o.tZ)(c.PersonalWorkspacePreview,{user:X,sx:t=>({padding:"".concat(t.space.$4," ").concat(t.space.$5),width:"100%"}),title:(0,a.localizationKeys)("organizationSwitcher.personalWorkspace")}),(0,o.tZ)(I,{onCreateOrganizationClick:()=>(l(),"navigation"===Z)?k():m({afterCreateOrganizationUrl:y,skipInvitationScreen:W,hideSlug:E}),onPersonalWorkspaceClick:()=>u.runAsync(()=>x({organization:null,redirectUrl:L(T)})).then(l),onOrganizationClick:t=>u.runAsync(()=>x({organization:t,redirectUrl:_(t)})).then(l)})]})}),(0,o.tZ)(c.PopoverCard.Footer,{elementDescriptor:a.descriptors.organizationSwitcherPopoverFooter})]})})}),$=(0,u.Ci)(t=>{var e;let{sx:i}=t,{organizationSettings:n}=(0,r.useEnvironment)(),a=null==n?void 0:null===(e=n.domains)||void 0===e?void 0:e.enabled,{membershipRequests:c}=(0,s.o8)({membershipRequests:a||void 0});return(null==c?void 0:c.count)?(0,o.tZ)(u.dN,{notificationCount:c.count,containerSx:i}):null},{permission:"org:sys_memberships:manage"}),k=(0,c.withAvatarShimmer)((0,n.forwardRef)((t,e)=>{let{sx:i,...n}=t,{user:l}=(0,s.aF)(),{organization:d}=(0,s.o8)(),{hidePersonal:u}=(0,r.useOrganizationSwitcherContext)();if(!l)return null;let{username:p,primaryEmailAddress:h,primaryPhoneNumber:v,...z}=l;return(0,o.BX)(a.Button,{elementDescriptor:a.descriptors.organizationSwitcherTrigger,variant:"ghost",colorScheme:"neutral",hoverAsFocus:!0,focusRing:!1,sx:[t=>({padding:"".concat(t.space.$1," ").concat(t.space.$2),position:"relative"}),i],ref:e,"aria-label":"".concat(t.isOpen?"Close":"Open"," organization switcher"),"aria-expanded":t.isOpen,"aria-haspopup":"dialog",...n,children:[d&&(0,o.tZ)(c.OrganizationPreview,{elementId:"organizationSwitcherTrigger",gap:3,size:"xs",fetchRoles:!0,organization:d,sx:{maxWidth:"30ch"}}),!d&&(0,o.tZ)(c.PersonalWorkspacePreview,{size:"xs",gap:3,user:z,showAvatar:!u,sx:t=>({color:t.colors.$colorTextSecondary}),title:u?(0,a.localizationKeys)("organizationSwitcher.notSelected"):(0,a.localizationKeys)("organizationSwitcher.personalWorkspace")}),(0,o.tZ)(D,{}),(0,o.tZ)(a.Icon,{elementDescriptor:a.descriptors.organizationSwitcherTriggerIcon,icon:g._M,sx:t=>({marginLeft:"".concat(t.space.$2)})})]})})),D=()=>{var t;let{userInvitations:e,userSuggestions:i}=(0,s.eW)(m.AO),{organizationSettings:n}=(0,r.useEnvironment)(),a=(0,u.N2)({permission:"org:sys_memberships:manage"}),c=null==n?void 0:null===(t=n.domains)||void 0===t?void 0:t.enabled,{membershipRequests:l}=(0,s.o8)({membershipRequests:c&&a||void 0}),d=(e.count||0)+(i.count||0)+((null==l?void 0:l.count)||0);return d?(0,o.tZ)(u.dN,{containerSx:t=>({position:"absolute",top:"-".concat(t.space.$2),right:"-".concat(t.space.$2)}),notificationCount:d}):null},_=(0,c.withFloatingTree)(t=>{let{children:e}=t,{defaultOpen:i}=(0,r.useOrganizationSwitcherContext)(),{floating:a,reference:s,styles:d,toggle:u,isOpen:p,nodeId:g,context:h}=(0,l.Sv)({defaultOpen:i,placement:"bottom-start",offset:8}),v=(0,n.useId)();return(0,o.BX)(o.HY,{children:[(0,o.tZ)(k,{ref:s,onClick:u,isOpen:p,"aria-controls":p?v:void 0,"aria-expanded":p}),(0,o.tZ)(c.Popover,{nodeId:g,context:h,isOpen:p,children:(0,n.cloneElement)(e,{id:v,close:u,ref:a,style:d})})]})}),L=(0,r.withCoreUserGuard)((0,c.withCardStateProvider)(()=>{let{__experimental_asStandalone:t}=(0,r.useOrganizationSwitcherContext)();return(0,o.tZ)(a.Flow.Root,{flow:"organizationSwitcher",sx:{display:"inline-flex"},children:(0,o.tZ)(r.AcceptedInvitationsProvider,{children:t?(0,o.tZ)(y,{close:"function"==typeof t?t:void 0}):(0,o.tZ)(_,{children:(0,o.tZ)(y,{})})})})}))},7484:function(t,e,i){i.d(e,{AO:function(){return o},Sz:function(){return n}});let o={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},n=(t,e,i)=>{var o;if(void 0===e)return[{data:[t],total_count:1}];let n=(null==e?void 0:null===(o=e[e.length-1])||void 0===o?void 0:o.total_count)||1;return e.map(e=>{if(void 0===e)return e;let o=e.data.map(e=>e.id===t.id?{...t}:e);return{...e,data:o,total_count:"negative"===i?n-1:n}})}}}]);